{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/aloye/Documents/adeyemi_frontend/app/%28dashboard%29/dashboard/admin/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport Link from \"next/link\";\nimport theme from \"@/styles/theme\";\nimport useUser from \"@/hooks/useUser\";\n// import { useUserStore } from \"@/lib/store\";\n\n/**\n * Admin Overview Dashboard\n * Tokens consumed:\n * - theme.colors.primary\n * - theme.colors.accent\n * - theme.colors.textPrimary / textOnPrimary\n * - theme.spacing\n * - theme.radius\n *\n * UI rules followed:\n * - Tailwind only (no inline styles)\n * - rounded-xl for cards\n * - shadow-md for major cards\n * - p-6 for main container & cards\n * - buttons have min height 2.5rem (class min-h-[2.5rem])\n *\n * Note: This page calls the following backend endpoints (implement if not present):\n * - GET  /api/admin/stats           -> { students, lecturers, courses, pendingApprovals }\n * - GET  /api/semester/active      -> active semester info\n * - POST /api/semester/start       -> start a new semester\n * - PATCH /api/semester/registration -> { status }\n * - PATCH /api/semester/results      -> { status }\n */\n\ntype Stats = {\n  students: number;\n  lecturers: number;\n  courses: number;\n  pendingApprovals: number;\n};\n\nexport default function AdminOverviewPage() {\n  const { user } = useUser();\n  const [stats, setStats] = useState<Stats | null>(null);\n  const [activeSemester, setActiveSemester] = useState<any>(null);\n  const [loading, setLoading] = useState(false);\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n\n  const fetchStats = async () => {\n    try {\n      const res = await fetch(\"/api/admin/stats\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) throw new Error(\"Failed to load stats\");\n      const data = await res.json();\n      setStats(data);\n    } catch (err) {\n      console.error(err);\n      setStats({ students: 0, lecturers: 0, courses: 0, pendingApprovals: 0 });\n    }\n  };\n\n  const fetchActiveSemester = async () => {\n    try {\n      const res = await fetch(\"/api/semester/active\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) {\n        setActiveSemester(null);\n        return;\n      }\n      const data = await res.json();\n      setActiveSemester(data);\n    } catch (err) {\n      console.error(err);\n      setActiveSemester(null);\n    }\n  };\n\n  useEffect(() => {\n    fetchStats();\n    fetchActiveSemester();\n  }, []);\n\n  // Quick actions\n  const startSemesterQuick = async () => {\n    const semName = prompt(\"Enter semester name (e.g. First Semester)\")?.trim();\n    const session = prompt(\"Enter session (e.g. 2025/2026)\")?.trim();\n    if (!semName || !session) return alert(\"Cancelled: missing fields.\");\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/semester/start\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ name: semName, session }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message || \"Failed\");\n      alert(json.message);\n      setActiveSemester(json.semester);\n    } catch (err: any) {\n      console.error(err);\n      alert(\"Error starting semester: \" + (err.message || err));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleRegistration = async (open: boolean) => {\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/semester/registration\", {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ status: open }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message || \"Failed\");\n      alert(json.message);\n      fetchActiveSemester(); // refresh\n      fetchStats();\n    } catch (err: any) {\n      console.error(err);\n      alert(\"Error toggling registration: \" + (err.message || err));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleResults = async (open: boolean) => {\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/semester/results\", {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ status: open }),\n      });\n      const json = await res.json();\n      if (!res.ok) throw new Error(json.message || \"Failed\");\n      alert(json.message);\n      fetchActiveSemester(); // refresh\n    } catch (err: any) {\n      console.error(err);\n      alert(\"Error toggling results: \" + (err.message || err));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <main className=\"max-w-6xl mx-auto p-6 min-h-screen\">\n      <header className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-primary mb-1\">Admin Overview</h1>\n        <p className=\"text-sm text-gray-600\">Welcome back{user?.name ? `, ${user.name}` : \"\"} — system summary at a glance.</p>\n      </header>\n\n      {/* Top row: active semester card + quick actions */}\n      <section className=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6\">\n        <div className=\"lg:col-span-2\">\n          <div className=\"rounded-xl shadow-md p-6 bg-surfaceElevated\">\n            <h2 className=\"text-lg font-semibold mb-2\">Active Semester</h2>\n            {activeSemester ? (\n              <div>\n                <p className=\"font-medium text-accent\">{activeSemester.name} — {activeSemester.session}</p>\n                <p className=\"text-sm text-gray-500 mt-1\">Started {new Date(activeSemester.createdAt).toLocaleString()}</p>\n                <div className=\"mt-4 flex flex-wrap gap-2\">\n                  <button\n                    className=\"min-h-[2.5rem] rounded-md px-4 py-2 bg-primary text-on-primary shadow-sm\"\n                    onClick={() => startSemesterQuick()}\n                    disabled={loading}\n                    aria-label=\"Start new semester\"\n                  >\n                    Start New Semester\n                  </button>\n                  <button\n                    className=\"min-h-[2.5rem] rounded-md px-4 py-2 border border-gray-200\"\n                    onClick={() => toggleRegistration(true)}\n                    disabled={loading}\n                    aria-label=\"Open registration\"\n                  >\n                    Open Registration\n                  </button>\n                  <button\n                    className=\"min-h-[2.5rem] rounded-md px-4 py-2 border border-gray-200\"\n                    onClick={() => toggleRegistration(false)}\n                    disabled={loading}\n                    aria-label=\"Close registration\"\n                  >\n                    Close Registration\n                  </button>\n                </div>\n              </div>\n            ) : (\n              <div>\n                <p className=\"text-gray-500\">No active semester. Start one to begin academic activities.</p>\n                <div className=\"mt-4\">\n                  <button\n                    className=\"min-h-[2.5rem] rounded-md px-4 py-2 bg-primary text-on-primary shadow-sm\"\n                    onClick={() => startSemesterQuick()}\n                    disabled={loading}\n                  >\n                    Start Semester\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Quick stats column */}\n        <aside className=\"space-y-4\">\n          <div className=\"rounded-xl shadow-md p-4 bg-surfaceElevated\">\n            <h3 className=\"text-sm font-medium text-gray-700 mb-2\">Quick Stats</h3>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <StatCard label=\"Students\" value={stats?.students ?? \"—\"} />\n              <StatCard label=\"Lecturers\" value={stats?.lecturers ?? \"—\"} />\n              <StatCard label=\"Courses\" value={stats?.courses ?? \"—\"} />\n              <StatCard label=\"Pending Approvals\" value={stats?.pendingApprovals ?? \"—\"} highlight />\n            </div>\n          </div>\n\n          <div className=\"rounded-xl shadow-md p-4 bg-surfaceElevated\">\n            <h3 className=\"text-sm font-medium text-gray-700 mb-2\">Shortcuts</h3>\n            <div className=\"flex flex-col gap-2\">\n              <Link href=\"/dashboard/admin/courses\" className=\"block min-h-[2.5rem] rounded-md px-3 py-2 border text-sm\">Manage Courses</Link>\n              <Link href=\"/dashboard/admin/lecturers\" className=\"block min-h-[2.5rem] rounded-md px-3 py-2 border text-sm\">Manage Lecturers</Link>\n              <Link href=\"/dashboard/admin/students\" className=\"block min-h-[2.5rem] rounded-md px-3 py-2 border text-sm\">Manage Students</Link>\n            </div>\n          </div>\n        </aside>\n      </section>\n\n      {/* Middle: pending approvals & activity summary */}\n      <section className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <div className=\"rounded-xl shadow-md p-6 bg-surfaceElevated\">\n          <h3 className=\"text-lg font-semibold mb-3\">Pending Result Approvals</h3>\n          <p className=\"text-sm text-gray-600\">View and approve results submitted by lecturers.</p>\n          <div className=\"mt-4\">\n            <Link href=\"/dashboard/admin/approvals\" className=\"min-h-[2.5rem] inline-block rounded-md px-4 py-2 bg-primary text-on-primary\">Go to Approvals</Link>\n          </div>\n        </div>\n\n        <div className=\"rounded-xl shadow-md p-6 bg-surfaceElevated\">\n          <h3 className=\"text-lg font-semibold mb-3\">System Activity</h3>\n          <p className=\"text-sm text-gray-600\">Recent logs and important admin actions.</p>\n          <div className=\"mt-4\">\n            <Link href=\"/dashboard/admin/logs\" className=\"min-h-[2.5rem] inline-block rounded-md px-4 py-2 border\">View Logs</Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer notes */}\n      <footer className=\"mt-8 text-sm text-gray-500\">\n        <p>Tip: use the shortcuts to jump to detailed sections. All actions here require admin privileges.</p>\n      </footer>\n    </main>\n  );\n}\n\n/* Small stat card component */\nfunction StatCard({ label, value, highlight = false }: { label: string; value: number | string; highlight?: boolean }) {\n  return (\n    <div className={`rounded-md p-3 ${highlight ? \"bg-primary text-on-primary\" : \"bg-white\"} shadow-sm`}>\n      <div className=\"text-xs font-medium\">{label}</div>\n      <div className=\"text-lg font-bold\">{value}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}